<div class="message_container" >
  <ul>
    <%
      conversation_user_ids = Array.new(Conversation.find(params[:id]).users)
      conversation_user_ids.delete(CURRENT_USER.to_s)
      conversation_names = Hash.new
      conversation_user_ids.each { |user_id| conversation_names[user_id] = User.find(user_id).name.split(' ')[0] }
    %>
    <% @messages.each_with_index do |message, i| %>
      <%
        to_conversation_names = Array.new
        conversation_names.each{ |key, value| to_conversation_names << value.split[0] unless message.user_id == key}
      %>
      <%= render message, :to_conversation_names => to_conversation_names %>
    <% end %>
  </ul>
</div>